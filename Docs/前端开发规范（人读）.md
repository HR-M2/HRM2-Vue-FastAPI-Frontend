# HRM2 å‰ç«¯å¼€å‘è§„èŒƒ

> æœ¬æ–‡æ¡£ä¸ºå¼€å‘è€…å’Œ AI ç¼–ç¨‹åŠ©æ‰‹æä¾›ä»£ç ç¼–å†™çš„çº¦æŸå’Œå»ºè®®ï¼Œç¡®ä¿ä»£ç é£æ ¼å’Œæ¶æ„ä¸€è‡´æ€§ã€‚

---

## ç›®å½•

1. [ä»£ç é£æ ¼çº¦å®š](#1-ä»£ç é£æ ¼çº¦å®š)
2. [Vue ç»„ä»¶è§„èŒƒ](#2-vue-ç»„ä»¶è§„èŒƒ)
3. [Composable ç¼–å†™è§„èŒƒ](#3-composable-ç¼–å†™è§„èŒƒ)
4. [ç±»å‹å®šä¹‰è§„èŒƒ](#4-ç±»å‹å®šä¹‰è§„èŒƒ)
5. [ç»„ä»¶ç›®å½•ç»„ç»‡](#5-ç»„ä»¶ç›®å½•ç»„ç»‡)
6. [API è°ƒç”¨è§„èŒƒ](#6-api-è°ƒç”¨è§„èŒƒ)
7. [æ ·å¼è§„èŒƒ](#7-æ ·å¼è§„èŒƒ)
8. [è·¯ç”±è§„èŒƒ](#8-è·¯ç”±è§„èŒƒ)
9. [æ–°åŠŸèƒ½å¼€å‘æµç¨‹](#9-æ–°åŠŸèƒ½å¼€å‘æµç¨‹)

---

## 1. ä»£ç é£æ ¼çº¦å®š

### 1.1 æ–‡ä»¶å‘½åè§„èŒƒ

| ç±»å‹ | å‘½åé£æ ¼ | ç¤ºä¾‹ |
|------|----------|------|
| Vue ç»„ä»¶ | `PascalCase.vue` | `PositionListPanel.vue` |
| Composable | `useCamelCase.ts` | `usePositionManagement.ts` |
| ç±»å‹æ–‡ä»¶ | `camelCase.ts` | `position.ts` |
| å·¥å…·å‡½æ•° | `camelCase.ts` | `formatDate.ts` |
| è·¯ç”±é…ç½® | `index.ts` | `router/index.ts` |

### 1.2 å˜é‡å‘½åè§„èŒƒ

| ç±»å‹ | å‘½åé£æ ¼ | ç¤ºä¾‹ |
|------|----------|------|
| å“åº”å¼å˜é‡ | `camelCase` | `positionData`, `isLoading` |
| å¸¸é‡ | `UPPER_SNAKE_CASE` | `DEFAULT_PAGE_SIZE` |
| å‡½æ•° | `camelCase` | `handleSubmit`, `loadPositions` |
| äº‹ä»¶å¤„ç† | `handle{Action}` | `handleSelectPosition`, `handleDelete` |
| å¸ƒå°”å€¼ | `is/has/can/should` å¼€å¤´ | `isSubmitting`, `hasChanges` |
| ç»„ä»¶ ref | `{name}Ref` | `editFormRef`, `dialogRef` |

### 1.3 æ³¨é‡Šè§„èŒƒ

**æ–‡ä»¶å¤´æ³¨é‡Š**ï¼ˆJSDoc é£æ ¼ï¼‰ï¼š
```typescript
/**
 * å²—ä½ç®¡ç† composable
 * å¤„ç†å²—ä½åˆ—è¡¨åŠ è½½ã€é€‰æ‹©ç­‰æ“ä½œ
 */
```

**å‡½æ•°æ³¨é‡Š**ï¼ˆç®€æ´æè¿°ï¼‰ï¼š
```typescript
// è®¡ç®—å†…å®¹å“ˆå¸Œ
const calculateHash = async (content: string): Promise<string> => {
  ...
}
```

**æ¨¡æ¿åŒºåŸŸæ³¨é‡Š**ï¼š
```vue
<template>
  <!-- é¡µé¢æ ‡é¢˜ -->
  <div class="page-header">...</div>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <div class="content-grid">...</div>
</template>
```

### 1.4 å¯¼å…¥é¡ºåº

æŒ‰ç…§ä»¥ä¸‹é¡ºåºç»„ç»‡å¯¼å…¥ï¼Œæ¯ç»„ä¹‹é—´ç©ºä¸€è¡Œï¼š

```typescript
// 1. Vue æ ¸å¿ƒ
import { ref, reactive, onMounted } from 'vue'

// 2. ç¬¬ä¸‰æ–¹åº“
import { ElMessage } from 'element-plus'
import { Plus, Delete } from '@element-plus/icons-vue'

// 3. æœ¬åœ°ç»„ä»¶
import { PositionListPanel, PositionEditForm } from '@/components/positions'

// 4. Composables
import { usePositionEditor } from '@/composables/usePositionEditor'

// 5. API
import { getPositions, createPosition } from '@/api/sdk.gen'

// 6. ç±»å‹ï¼ˆä½¿ç”¨ type å…³é”®å­—ï¼‰
import type { PositionListResponse } from '@/api/types.gen'
import type { PositionData } from '@/types'
```

---

## 2. Vue ç»„ä»¶è§„èŒƒ

### 2.1 SFC ç»“æ„é¡ºåº

```vue
<template>
  <!-- æ¨¡æ¿å†…å®¹ -->
</template>

<script setup lang="ts">
// è„šæœ¬é€»è¾‘
</script>

<style scoped>
/* æ ·å¼ */
</style>
```

### 2.2 Script åŒºå—ç»„ç»‡

æŒ‰ç…§ä»¥ä¸‹é¡ºåºç»„ç»‡ `<script setup>` å†…å®¹ï¼š

```typescript
<script setup lang="ts">
// ========== å¯¼å…¥ ==========
import { ref, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import { PositionListPanel } from '@/components/positions'
import { usePositionEditor } from '@/composables/usePositionEditor'
import type { PositionListResponse } from '@/api/types.gen'

// ========== Props & Emits ==========
const props = defineProps<{
  positions: PositionListResponse[]
  loading: boolean
}>()

const emit = defineEmits<{
  select: [pos: PositionListResponse]
  delete: [pos: PositionListResponse]
}>()

// ========== Composables è§£æ„ ==========
const {
  loading,
  positions,
  loadPositions,
  selectPosition
} = usePositionEditor()

// ========== æœ¬åœ°çŠ¶æ€ ==========
const dialogVisible = ref(false)
const editFormRef = ref<InstanceType<typeof PositionEditForm>>()

// ========== è®¡ç®—å±æ€§ ==========
const hasSelection = computed(() => selectedId.value !== null)

// ========== æ–¹æ³• ==========
const handleSelectPosition = (pos: PositionListResponse) => {
  selectPosition(pos)
}

const handleSave = async () => {
  // ä¸šåŠ¡é€»è¾‘
}

// ========== ç”Ÿå‘½å‘¨æœŸ ==========
onMounted(() => {
  loadPositions()
})
</script>
```

### 2.3 Props å®šä¹‰è§„èŒƒ

ä½¿ç”¨æ³›å‹è¯­æ³•å®šä¹‰ Propsï¼š

```typescript
// âœ… æ¨èï¼šæ³›å‹è¯­æ³•
defineProps<{
  positions: PositionListResponse[]
  selectedPositionId: string | null
  loading: boolean
}>()

// âŒ ä¸æ¨èï¼šè¿è¡Œæ—¶å£°æ˜
defineProps({
  positions: { type: Array, required: true },
  loading: { type: Boolean, default: false }
})
```

### 2.4 Emits å®šä¹‰è§„èŒƒ

ä½¿ç”¨æ³›å‹è¯­æ³•å®šä¹‰ Emitsï¼Œå‚æ•°ä½¿ç”¨å…ƒç»„ï¼š

```typescript
// âœ… æ¨è
defineEmits<{
  select: [pos: PositionListResponse]
  delete: [pos: PositionListResponse]
  create: []
  'update:modelValue': [value: string]
}>()

// åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨
<div @click="$emit('select', pos)">
```

### 2.5 æ¨¡æ¿è§„èŒƒ

**æ¡ä»¶æ¸²æŸ“é¡ºåº**ï¼š`v-if` â†’ `v-else-if` â†’ `v-else`

```vue
<div v-if="loading" class="loading">åŠ è½½ä¸­...</div>
<div v-else-if="items.length === 0" class="empty">æš‚æ— æ•°æ®</div>
<div v-else class="list">
  <!-- åˆ—è¡¨å†…å®¹ -->
</div>
```

**å¤šå±æ€§æ¢è¡Œ**ï¼š

```vue
<!-- âœ… æ¨èï¼šå¤šå±æ€§æ¢è¡Œ -->
<el-button
  type="primary"
  size="small"
  :loading="submitting"
  @click="handleSubmit"
>
  æäº¤
</el-button>

<!-- âŒ ä¸æ¨èï¼šä¸€è¡Œè¿‡é•¿ -->
<el-button type="primary" size="small" :loading="submitting" @click="handleSubmit">æäº¤</el-button>
```

---

## 3. Composable ç¼–å†™è§„èŒƒ

### 3.1 æ–‡ä»¶ç»“æ„

```typescript
/**
 * {åŠŸèƒ½åç§°} composable
 * {åŠŸèƒ½æè¿°}
 */
import { ref, type Ref } from 'vue'
import { ElMessage } from 'element-plus'
import { apiFunction } from '@/api/sdk.gen'
import type { SomeType } from '@/api/types.gen'

export function use{FeatureName}(
  // å¯é€‰å‚æ•°
  someRef?: Ref<SomeType>,
  onSuccess?: (result: SomeType) => void
) {
  // ========== çŠ¶æ€ ==========
  const isLoading = ref(false)
  const data = ref<SomeType | null>(null)

  // ========== æ–¹æ³• ==========
  const loadData = async () => {
    isLoading.value = true
    try {
      const response = await apiFunction()
      data.value = response.data?.data || null
    } catch (err) {
      console.error('åŠ è½½å¤±è´¥:', err)
      ElMessage.error('åŠ è½½å¤±è´¥')
    } finally {
      isLoading.value = false
    }
  }

  const handleAction = async () => {
    // ä¸šåŠ¡é€»è¾‘
    onSuccess?.(result)
  }

  // ========== è¿”å› ==========
  return {
    // çŠ¶æ€
    isLoading,
    data,
    // æ–¹æ³•
    loadData,
    handleAction
  }
}
```

### 3.2 å‘½åè§„èŒƒ

| åœºæ™¯ | å‘½å | ç¤ºä¾‹ |
|------|------|------|
| åŠ è½½çŠ¶æ€ | `isLoading` / `loading` | `isLoading.value = true` |
| æäº¤çŠ¶æ€ | `isSubmitting` / `submitting` | `isSubmitting.value = true` |
| æ•°æ®åŠ è½½æ–¹æ³• | `load{Data}` | `loadPositions()` |
| æ“ä½œæ–¹æ³• | `handle{Action}` | `handleSubmit()` |
| å·¥å…·æ–¹æ³• | åŠ¨è¯å¼€å¤´ | `calculateHash()`, `formatDate()` |

### 3.3 è¿”å›å€¼è§„èŒƒ

ç»Ÿä¸€è¿”å›å¯¹è±¡ï¼ŒåŒ…å«çŠ¶æ€å’Œæ–¹æ³•ï¼š

```typescript
return {
  // å“åº”å¼çŠ¶æ€
  isLoading,
  isSubmitting,
  data,
  errorMessage,
  
  // æ–¹æ³•
  loadData,
  submitData,
  resetForm,
  
  // è®¡ç®—å±æ€§ï¼ˆå¦‚æœ‰ï¼‰
  hasData,
  isValid
}
```

---

## 4. ç±»å‹å®šä¹‰è§„èŒƒ

### 4.1 ç±»å‹æ¥æº

| æ¥æº | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| API è‡ªåŠ¨ç”Ÿæˆ | `@/api/types.gen` | åç«¯ API å“åº”ç±»å‹ï¼Œ**ç¦æ­¢æ‰‹åŠ¨ä¿®æ”¹** |
| å‰ç«¯æ‰©å±•ç±»å‹ | `@/types/` | å‰ç«¯ç‰¹æœ‰çš„ç±»å‹å®šä¹‰ |

### 4.2 å‰ç«¯ç±»å‹å®šä¹‰

åªæœ‰å½“éœ€è¦**æ‰©å±•æˆ–ç»„åˆ** API ç±»å‹æ—¶ï¼Œæ‰åœ¨ `src/types/` åˆ›å»ºï¼š

```typescript
// src/types/position.ts
/**
 * å²—ä½ç›¸å…³ç±»å‹å®šä¹‰
 */
import type { ResumeData } from './resume'

/**
 * å²—ä½æ•°æ®ï¼ˆå‰ç«¯æ‰©å±•ï¼‰
 */
export interface PositionData {
  id: string
  title: string
  department?: string
  // ... åŸºç¡€å­—æ®µ
  
  // å‰ç«¯æ‰©å±•å­—æ®µ
  resume_count?: number
  resumes?: ResumeData[]
}
```

### 4.3 æ¡¶æ–‡ä»¶å¯¼å‡º

åœ¨ `src/types/index.ts` ç»Ÿä¸€å¯¼å‡ºï¼š

```typescript
/**
 * å‰ç«¯ç‰¹æœ‰ç±»å‹å®šä¹‰ - æ¡¶æ–‡ä»¶
 * 
 * æ³¨æ„ï¼šAPI è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹è¯·ç›´æ¥ä» '@/api/types.gen' å¯¼å…¥
 */

// ç®€å†ç›¸å…³
export type { ResumeData, ResumeFile } from './resume'

// å²—ä½ç›¸å…³
export type { PositionData } from './position'

// ä»»åŠ¡ç›¸å…³
export type { TaskStatus, ProcessingTask } from './task'
```

### 4.4 ç±»å‹å¯¼å…¥è§„èŒƒ

```typescript
// âœ… ä½¿ç”¨ type å…³é”®å­—å¯¼å…¥ç±»å‹
import type { PositionListResponse } from '@/api/types.gen'
import type { PositionData } from '@/types'

// âŒ ä¸æ¨èï¼šä¸ä½¿ç”¨ type å…³é”®å­—
import { PositionListResponse } from '@/api/types.gen'
```

---

## 5. ç»„ä»¶ç›®å½•ç»„ç»‡

### 5.1 ç›®å½•ç»“æ„

```
src/components/
â”œâ”€â”€ common/                 # é€šç”¨ç»„ä»¶ï¼ˆè·¨æ¨¡å—å¤ç”¨ï¼‰
â”‚   â”œâ”€â”€ LoadingSpinner.vue
â”‚   â””â”€â”€ EmptyState.vue
â”œâ”€â”€ layout/                 # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ MainLayout.vue
â”‚   â”œâ”€â”€ AppSidebar.vue
â”‚   â””â”€â”€ AppHeader.vue
â”œâ”€â”€ {module}/               # ä¸šåŠ¡æ¨¡å—ç»„ä»¶
â”‚   â”œâ”€â”€ {Module}ListPanel.vue
â”‚   â”œâ”€â”€ {Module}EditForm.vue
â”‚   â”œâ”€â”€ {Module}Dialog.vue
â”‚   â””â”€â”€ index.ts            # å¯¼å‡ºæ–‡ä»¶
```

### 5.2 ç»„ä»¶å‘½åè§„èŒƒ

| ç±»å‹ | å‘½åæ¨¡å¼ | ç¤ºä¾‹ |
|------|----------|------|
| åˆ—è¡¨é¢æ¿ | `{Module}ListPanel.vue` | `PositionListPanel.vue` |
| ç¼–è¾‘è¡¨å• | `{Module}EditForm.vue` | `PositionEditForm.vue` |
| å¯¹è¯æ¡† | `{Module}Dialog.vue` | `PositionJsonDialog.vue` |
| æŠ½å±‰ | `{Module}Drawer.vue` | `PositionAIGenerateDrawer.vue` |
| å¡ç‰‡ | `{Module}Card.vue` | `CandidateCard.vue` |

### 5.3 æ¨¡å—å¯¼å‡ºæ–‡ä»¶

æ¯ä¸ªæ¨¡å—ç›®å½•å¿…é¡»æœ‰ `index.ts`ï¼š

```typescript
// src/components/positions/index.ts
export { default as PositionListPanel } from './PositionListPanel.vue'
export { default as PositionEditForm } from './PositionEditForm.vue'
export { default as PositionAIGenerateDrawer } from './PositionAIGenerateDrawer.vue'
export { default as PositionJsonDialog } from './PositionJsonDialog.vue'
```

ä½¿ç”¨æ—¶ç»Ÿä¸€ä»æ¨¡å—å¯¼å…¥ï¼š

```typescript
// âœ… æ¨è
import { PositionListPanel, PositionEditForm } from '@/components/positions'

// âŒ ä¸æ¨è
import PositionListPanel from '@/components/positions/PositionListPanel.vue'
import PositionEditForm from '@/components/positions/PositionEditForm.vue'
```

---

## 6. API è°ƒç”¨è§„èŒƒ

### 6.1 ä½¿ç”¨ç”Ÿæˆçš„ SDK

ç›´æ¥è°ƒç”¨ `@/api/sdk.gen` ä¸­çš„å‡½æ•°ï¼š

```typescript
import { getPositions, createPosition, deletePosition } from '@/api/sdk.gen'

// è°ƒç”¨ API
const response = await getPositions({
  query: { page: 1, page_size: 20 }
})

// è®¿é—®æ•°æ®
const items = response.data?.data?.items || []
```

### 6.2 é”™è¯¯å¤„ç†æ¨¡å¼

```typescript
const loadData = async () => {
  isLoading.value = true
  try {
    const response = await getPositions({ query: { page_size: 100 } })
    
    if (response.data?.data?.items) {
      positions.value = response.data.data.items
    }
  } catch (err) {
    console.error('åŠ è½½å²—ä½åˆ—è¡¨å¤±è´¥:', err)
    ElMessage.error('åŠ è½½å²—ä½åˆ—è¡¨å¤±è´¥')
  } finally {
    isLoading.value = false
  }
}
```

### 6.3 ä¹è§‚æ›´æ–°æ¨¡å¼

å¯¹äºåˆ é™¤ã€æ›´æ–°ç­‰æ“ä½œï¼Œå…ˆæ›´æ–° UIï¼Œå¤±è´¥åå›æ»šï¼š

```typescript
const removeItem = async (item: ItemType) => {
  // 1. ä¿å­˜åŸå§‹çŠ¶æ€
  const originalItems = [...items.value]
  const originalCount = items.value.length
  
  // 2. ä¹è§‚æ›´æ–° UI
  items.value = items.value.filter(i => i.id !== item.id)
  
  try {
    // 3. è°ƒç”¨ API
    await deleteItem({ path: { id: item.id } })
    ElMessage.success('åˆ é™¤æˆåŠŸ')
  } catch (err) {
    // 4. å¤±è´¥æ—¶å›æ»š
    console.error('åˆ é™¤å¤±è´¥:', err)
    ElMessage.error('åˆ é™¤å¤±è´¥')
    items.value = originalItems
  }
}
```

### 6.4 API å®¢æˆ·ç«¯é‡æ–°ç”Ÿæˆ

å½“åç«¯ API å˜æ›´æ—¶ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°ç”Ÿæˆï¼š

```bash
# ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:8000
npm run api:gen
```

ç”Ÿæˆçš„æ–‡ä»¶ï¼š
- `src/api/sdk.gen.ts` - API è°ƒç”¨å‡½æ•°
- `src/api/types.gen.ts` - TypeScript ç±»å‹å®šä¹‰
- `src/api/client.gen.ts` - å®¢æˆ·ç«¯é…ç½®

> âš ï¸ **æ³¨æ„**ï¼šç”Ÿæˆçš„æ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼Œ**ç¦æ­¢æ‰‹åŠ¨ä¿®æ”¹**ã€‚å¦‚éœ€å°è£…ï¼Œåœ¨ `src/api/index.ts` ä¸­è¿›è¡Œã€‚

---

## 7. æ ·å¼è§„èŒƒ

### 7.1 scoped æ ·å¼

æ‰€æœ‰ç»„ä»¶å¿…é¡»ä½¿ç”¨ `scoped` æ ·å¼éš”ç¦»ï¼š

```vue
<style scoped>
.position-item {
  padding: 12px;
  background: #fafafa;
}
</style>
```

### 7.2 æ·±åº¦é€‰æ‹©å™¨

ä¿®æ”¹ Element Plus ç»„ä»¶å†…éƒ¨æ ·å¼æ—¶ä½¿ç”¨ `:deep()`ï¼š

```css
.positions-list-card :deep(.el-card__header) {
  padding: 16px 20px;
  background-color: #fafafa;
}
```

### 7.3 ç±»åå‘½å

ä½¿ç”¨è¯­ä¹‰åŒ–å‘½åæˆ– BEM ç®€åŒ–ç‰ˆï¼š

```css
/* è¯­ä¹‰åŒ–å‘½å */
.page-header { }
.page-title { }
.content-grid { }
.position-item { }
.position-item.active { }

/* çŠ¶æ€ä¿®é¥° */
.position-item:hover { }
.position-item.active { }
.position-item.disabled { }
```

### 7.4 å“åº”å¼è®¾è®¡

ä½¿ç”¨åª’ä½“æŸ¥è¯¢å¤„ç†å“åº”å¼ï¼š

```css
.content-grid {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 24px;
}

@media (max-width: 1000px) {
  .content-grid {
    grid-template-columns: 1fr;
  }
}
```

### 7.5 Element Plus ä¼˜å…ˆ

ä¼˜å…ˆä½¿ç”¨ Element Plus ç»„ä»¶å’Œæ ·å¼å˜é‡ï¼Œé¿å…é‡å¤é€ è½®å­ï¼š

```vue
<!-- âœ… ä½¿ç”¨ Element Plus -->
<el-button type="primary">æäº¤</el-button>
<el-tag type="success">å·²å®Œæˆ</el-tag>
<el-empty description="æš‚æ— æ•°æ®" />

<!-- âŒ é¿å…è‡ªå®šä¹‰åŸºç¡€ç»„ä»¶ -->
<button class="custom-btn">æäº¤</button>
```

---

## 8. è·¯ç”±è§„èŒƒ

### 8.1 è·¯ç”±é…ç½®ç»“æ„

```typescript
// src/router/index.ts
import { createRouter, createWebHistory } from 'vue-router'
import MainLayout from '@/components/layout/MainLayout.vue'

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    {
      path: '/',
      component: MainLayout,
      children: [
        {
          path: '',
          name: 'dashboard',
          component: () => import('@/views/DashboardView.vue'),
          meta: { title: 'ä»ªè¡¨ç›˜ - HRM2æ‹›è˜ç®¡ç†ç³»ç»Ÿ' }
        },
        {
          path: 'positions',
          name: 'positions',
          component: () => import('@/views/PositionsView.vue'),
          meta: { title: 'å²—ä½è®¾ç½® - HRM2æ‹›è˜ç®¡ç†ç³»ç»Ÿ' }
        }
        // ...
      ]
    }
  ]
})
```

### 8.2 è·¯ç”±è§„èŒƒè¦ç‚¹

| è§„èŒƒ | è¯´æ˜ |
|------|------|
| æ‡’åŠ è½½ | ä½¿ç”¨ `() => import()` åŠ¨æ€å¯¼å…¥ |
| å‘½åè·¯ç”± | ä½¿ç”¨ `name` å±æ€§ï¼Œé‡‡ç”¨ `kebab-case` |
| Meta ä¿¡æ¯ | è®¾ç½® `title` ç”¨äºé¡µé¢æ ‡é¢˜ |
| åµŒå¥—è·¯ç”± | ä½¿ç”¨ `MainLayout` åŒ…è£¹ä¸šåŠ¡é¡µé¢ |

### 8.3 é¡µé¢æ ‡é¢˜è®¾ç½®

é€šè¿‡è·¯ç”±å®ˆå«è‡ªåŠ¨è®¾ç½®ï¼š

```typescript
router.beforeEach((to, from, next) => {
  if (to.meta?.title) {
    document.title = to.meta.title as string
  } else {
    document.title = 'HRM2æ‹›è˜ç®¡ç†ç³»ç»Ÿ'
  }
  next()
})
```

---

## 9. æ–°åŠŸèƒ½å¼€å‘æµç¨‹

ä»¥æ·»åŠ æ–°ä¸šåŠ¡æ¨¡å— `{Module}` ä¸ºä¾‹ï¼š

### Step 1: å®šä¹‰å‰ç«¯ç±»å‹ï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æœéœ€è¦æ‰©å±• API ç±»å‹ï¼Œåœ¨ `src/types/{module}.ts` åˆ›å»ºï¼š

```typescript
/**
 * {æ¨¡å—}ç›¸å…³ç±»å‹å®šä¹‰
 */
export interface {Module}Data {
  id: string
  // ... å‰ç«¯æ‰©å±•å­—æ®µ
}
```

åœ¨ `src/types/index.ts` ä¸­å¯¼å‡ºï¼š

```typescript
export type { {Module}Data } from './{module}'
```

### Step 2: åˆ›å»º Composable

åœ¨ `src/composables/use{Module}.ts` åˆ›å»ºä¸šåŠ¡é€»è¾‘ï¼š

```typescript
/**
 * {æ¨¡å—}ç®¡ç† composable
 */
export function use{Module}() {
  const loading = ref(false)
  const items = ref<{Module}Data[]>([])
  
  const loadItems = async () => { ... }
  
  return { loading, items, loadItems }
}
```

### Step 3: åˆ›å»ºç»„ä»¶

åœ¨ `src/components/{module}/` åˆ›å»ºç»„ä»¶ï¼š

```
src/components/{module}/
â”œâ”€â”€ {Module}ListPanel.vue
â”œâ”€â”€ {Module}EditForm.vue
â””â”€â”€ index.ts
```

åˆ›å»ºå¯¼å‡ºæ–‡ä»¶ `index.ts`ï¼š

```typescript
export { default as {Module}ListPanel } from './{Module}ListPanel.vue'
export { default as {Module}EditForm } from './{Module}EditForm.vue'
```

### Step 4: åˆ›å»ºé¡µé¢è§†å›¾

åœ¨ `src/views/{Module}View.vue` åˆ›å»ºé¡µé¢ï¼š

```vue
<template>
  <div class="{module}-view">
    <!-- é¡µé¢å†…å®¹ -->
  </div>
</template>

<script setup lang="ts">
import { {Module}ListPanel, {Module}EditForm } from '@/components/{module}'
import { use{Module} } from '@/composables/use{Module}'
// ...
</script>
```

### Step 5: æ·»åŠ è·¯ç”±

åœ¨ `src/router/index.ts` æ·»åŠ è·¯ç”±é…ç½®ï¼š

```typescript
{
  path: '{module}',
  name: '{module}',
  component: () => import('@/views/{Module}View.vue'),
  meta: { title: '{æ¨¡å—åç§°} - HRM2æ‹›è˜ç®¡ç†ç³»ç»Ÿ' }
}
```

### Step 6: æ·»åŠ å¯¼èˆª

åœ¨ `src/components/layout/AppSidebar.vue` æ·»åŠ å¯¼èˆªé¡¹ã€‚

### Step 7: éªŒè¯

1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`
2. è®¿é—®æ–°é¡µé¢éªŒè¯åŠŸèƒ½
3. è¿è¡Œç±»å‹æ£€æŸ¥ï¼š`npm run type-check`

---

## é™„å½•ï¼šå¸¸ç”¨ä»£ç ç‰‡æ®µ

### View é¡µé¢æ¨¡æ¿

```vue
<template>
  <div class="{module}-view">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="page-header">
      <h1 class="page-title">{æ¨¡å—åç§°}</h1>
      <p class="page-desc">{æ¨¡å—æè¿°}</p>
    </div>

    <!-- ä¸»å†…å®¹ -->
    <div class="content-area">
      <!-- å†…å®¹ -->
    </div>
  </div>
</template>

<script setup lang="ts">
import { onMounted } from 'vue'
import { use{Module} } from '@/composables/use{Module}'

const { loading, items, loadItems } = use{Module}()

onMounted(() => {
  loadItems()
})
</script>

<style scoped>
.{module}-view {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.page-header {
  margin-bottom: 8px;
}

.page-title {
  margin: 0 0 8px 0;
  font-size: 24px;
  font-weight: 600;
  color: #303133;
}

.page-desc {
  margin: 0;
  font-size: 14px;
  color: #909399;
}
</style>
```

### Composable æ¨¡æ¿

```typescript
/**
 * {æ¨¡å—}ç®¡ç† composable
 * {åŠŸèƒ½æè¿°}
 */
import { ref } from 'vue'
import { ElMessage } from 'element-plus'
import { getItems, createItem, deleteItem } from '@/api/sdk.gen'
import type { ItemResponse } from '@/api/types.gen'

export function use{Module}() {
  // çŠ¶æ€
  const loading = ref(false)
  const items = ref<ItemResponse[]>([])

  // åŠ è½½åˆ—è¡¨
  const loadItems = async () => {
    loading.value = true
    try {
      const response = await getItems({ query: { page_size: 100 } })
      items.value = response.data?.data?.items || []
    } catch (err) {
      console.error('åŠ è½½å¤±è´¥:', err)
      ElMessage.error('åŠ è½½å¤±è´¥')
    } finally {
      loading.value = false
    }
  }

  // åˆ›å»º
  const handleCreate = async (data: CreateData) => {
    try {
      await createItem({ body: data })
      ElMessage.success('åˆ›å»ºæˆåŠŸ')
      await loadItems()
    } catch (err) {
      console.error('åˆ›å»ºå¤±è´¥:', err)
      ElMessage.error('åˆ›å»ºå¤±è´¥')
    }
  }

  return {
    loading,
    items,
    loadItems,
    handleCreate
  }
}
```

### ç»„ä»¶ Props/Emits æ¨¡æ¿

```vue
<script setup lang="ts">
import type { ItemResponse } from '@/api/types.gen'

// Props
const props = defineProps<{
  items: ItemResponse[]
  selectedId: string | null
  loading: boolean
}>()

// Emits
const emit = defineEmits<{
  select: [item: ItemResponse]
  delete: [item: ItemResponse]
  create: []
}>()

// äº‹ä»¶å¤„ç†
const handleSelect = (item: ItemResponse) => {
  emit('select', item)
}
</script>
```

---

> ğŸ“ **ç»´æŠ¤è¯´æ˜**ï¼šæœ¬æ–‡æ¡£éšé¡¹ç›®æ¶æ„æ¼”è¿›è€Œæ›´æ–°ã€‚å¦‚æœ‰ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·åŠæ—¶åé¦ˆã€‚
